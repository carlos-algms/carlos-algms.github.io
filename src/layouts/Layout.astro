---
import '../styles/global.css';
import { t, type TranslationsLang } from '../lang/translations';
import { getRelativeLocaleUrl } from 'astro:i18n';

import LinkedInIcon from '../assets/icons/linkedin.svg';
import GitHubIcon from '../assets/icons/github.svg';
import { cn } from '../styles/classes';

type Props = {
  title?: string;
  lang: TranslationsLang;
};

const { title, lang = 'pt-br' } = Astro.props;
const name = 'Carlos A. Gomes';
const fullTitle = title ? `${title} | ${name}` : name;
---

<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="icon"
      sizes="256x256"
      type="image/png"
      href="/images/favicon.png"
    />
    <link
      rel="icon"
      sizes="16x16"
      type="image/x-icon"
      href="/images/favicon.ico"
    />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/images/apple-touch-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/images/apple-touch-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/images/apple-touch-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/images/apple-touch-icon-144x144.png"
    />
    <title>{fullTitle}</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      crossorigin="anonymous"
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&display=swap"
    />

    <link rel="sitemap" href="/sitemap-index.xml" />

    <slot name="head" />

    <script
      is:inline
      type="text/partytown"
      async
      src={`https://www.googletagmanager.com/gtag/js?id=G-ZNQ41VTYXZ`}></script>

    <script is:inline type="text/partytown">
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }

      gtag('js', new Date());

      // Initialize as Anonymous until we have a proper consent management
      gtag('consent', 'default', {
        ad_storage: 'denied',
        ad_user_data: 'denied',
        ad_personalization: 'denied',
        analytics_storage: 'denied',
      });

      gtag('config', 'G-ZNQ41VTYXZ');
    </script>

    <script is:inline data-category="analytics">
      function updateConsents() {
        if (typeof gtag !== 'function') {
          console.warn('gtag is not defined');
          return;
        }

        gtag('consent', 'update', {
          ad_storage: 'granted',
          ad_user_data: 'granted',
          ad_personalization: 'granted',
          analytics_storage: 'granted',
        });
      }
    </script>
  </head>
  <body class="relative flex flex-col min-h-dvh">
    <header
      class="sticky top-0 z-10 h-16 dark:bg-neutral-900/50 backdrop-blur-xl"
    >
      <div class="container mx-auto flex h-full items-center justify-between">
        <a
          class="hover:text-accent font-bold text-lg"
          href={getRelativeLocaleUrl(lang, '/')}
        >
          Carlos A. Gomes
        </a>
        <nav>
          <ul class="flex gap-4">
            <li>
              <a
                class="hover:text-accent"
                href={getRelativeLocaleUrl(lang, '/')}>{t('home', lang)}</a
              >
            </li>
            <li>
              <a
                class="hover:text-accent"
                href={getRelativeLocaleUrl(lang, 'blog')}>{t('blog', lang)}</a
              >
            </li>
            <li>
              <a
                class="hover:text-accent"
                href={getRelativeLocaleUrl(lang, 'experiments')}
                >{t('experiments', lang)}</a
              >
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="flex-1">
      <slot />
    </main>

    <footer
      class="border-t border-zinc-300 dark:border-zinc-700 dark:bg-muted/40 mt-10 pb-15 pt-10"
    >
      <div class="container mx-auto flex flex-col gap-10 sm:flex-row">
        <aside class="flex flex-col gap-2">
          <h3 class="font-bold">Carlos A. Gomes</h3>
          <div class="flex flex-row gap-3">
            <a
              href="https://github.com/carlos-algms"
              target="_blank"
              class={cn(
                'inline-flex items-center justify-center rounded-full w-8 h-8 text-sm font-medium transition-colors',
                'border border-zinc-300 dark:border-zinc-700 border-input bg-background',
                'hover:bg-accent hover:text-accent-foreground',
              )}
              aria-label="Carlos Gomes GitHub Profile"
            >
              <GitHubIcon class="h-4 w-4" />
            </a>

            <a
              href="https://www.linkedin.com/in/carlosalgms/"
              target="_blank"
              class={cn(
                'inline-flex items-center justify-center rounded-full w-8 h-8 text-sm font-medium transition-colors',
                'border border-zinc-300 dark:border-zinc-700 border-input bg-background',
                'hover:bg-accent hover:text-accent-foreground',
              )}
              aria-label="Carlos Gomes LinkedIn Profile"
            >
              <LinkedInIcon class="h-4 w-4" />
            </a>
          </div>
        </aside>
        <aside class="flex flex-col gap-2">
          <h4 class="font-bold">Links</h4>

          <ul class="flex flex-col gap-1 dark:text-muted-foreground">
            <li>
              <a
                class="hover:text-accent"
                href={getRelativeLocaleUrl(lang, '/')}>{t('home', lang)}</a
              >
            </li>
            <li>
              <a
                class="hover:text-accent"
                href={getRelativeLocaleUrl(lang, 'blog')}>{t('blog', lang)}</a
              >
            </li>
            <li>
              <a
                class="hover:text-accent"
                href={getRelativeLocaleUrl(lang, 'experiments')}
                >{t('experiments', lang)}</a
              >
            </li>
          </ul>
        </aside>
      </div>
      <div
        class="container mx-auto mt-10 dark:text-muted-foreground flex justify-between border-t border-zinc-300 dark:border-zinc-800 pt-4"
      >
        <aside>Â© 2025 All rights reserved.</aside>
        <aside>Powered by Astro</aside>
      </div>
    </footer>
  </body>
</html>

<script type="application/ld+json" is:inline>
  {
    "@context": "http://schema.org",
    "@type": "Person",
    "name": "Carlos A. Gomes",
    "email": "carlos.algms@gmail.com",
    "jobTitle": "Frontend Engineer",
    "gender": "Male",
    "url": "https://github.com/carlos-algms",
    "image": "https://github.com/carlos-algms.png",
    "sameAs": [
      "https://www.linkedin.com/in/carlosalgms/",
      "https://twitter.com/carlos_algms"
    ]
  }
</script>
