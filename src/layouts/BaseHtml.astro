---
import '../styles/global.css';
import { type TranslationsLang } from '../lang/translations';

type Props = {
  title?: string;
  lang: TranslationsLang;
};

const { title, lang = 'pt-br' } = Astro.props;
const name = 'Carlos A. Gomes';
const fullTitle = title ? `${title} | ${name}` : name;
---

<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="icon"
      sizes="256x256"
      type="image/png"
      href="/images/favicon.png"
    />
    <link
      rel="icon"
      sizes="16x16"
      type="image/x-icon"
      href="/images/favicon.ico"
    />
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="/images/apple-touch-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="/images/apple-touch-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/images/apple-touch-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="/images/apple-touch-icon-144x144.png"
    />
    <title>{fullTitle}</title>

    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
      crossorigin="anonymous"
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      crossorigin="anonymous"
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&display=swap"
    />

    <link rel="sitemap" href="/sitemap-index.xml" />

    <slot name="head" />

    <script
      is:inline
      type="text/partytown"
      async
      src={`https://www.googletagmanager.com/gtag/js?id=G-ZNQ41VTYXZ`}></script>

    <script is:inline type="text/partytown">
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }

      gtag('js', new Date());

      // Initialize as Anonymous until we have a proper consent management
      gtag('consent', 'default', {
        ad_storage: 'denied',
        ad_user_data: 'denied',
        ad_personalization: 'denied',
        analytics_storage: 'denied',
      });

      gtag('config', 'G-ZNQ41VTYXZ');
    </script>

    <script is:inline data-category="analytics">
      function updateConsents() {
        if (typeof gtag !== 'function') {
          console.warn('gtag is not defined');
          return;
        }

        gtag('consent', 'update', {
          ad_storage: 'granted',
          ad_user_data: 'granted',
          ad_personalization: 'granted',
          analytics_storage: 'granted',
        });
      }
    </script>
  </head>
  <body class="relative flex flex-col min-h-dvh">
    <slot />
  </body>
</html>

<script type="application/ld+json" is:inline>
  {
    "@context": "http://schema.org",
    "@type": "Person",
    "name": "Carlos A. Gomes",
    "email": "carlos.algms@gmail.com",
    "jobTitle": "Frontend Engineer",
    "gender": "Male",
    "url": "https://github.com/carlos-algms",
    "image": "https://github.com/carlos-algms.png",
    "sameAs": [
      "https://www.linkedin.com/in/carlosalgms/",
      "https://twitter.com/carlos_algms"
    ]
  }
</script>
